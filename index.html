<!-- Senin index.html tasarımın buraya kadar aynı kalsın -->

<!-- Supabase Auth scriptleri -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
  // Supabase client
  const supa = supabase.createClient(
    "https://gukdmxepdgwrwniectnq.supabase.co",   // Supabase Project URL
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1a2RteGVwZGd3cnduaWVjdG5xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NzgyODAsImV4cCI6MjA3MTQ1NDI4MH0.57j4LbCHdhoaYl05PBTRjNyQAV3SxvL07GUredTDWZU"            // Supabase anon key
  );

  // Kayıt ol
  async function signup(farmName, email, password){
    const { data, error } = await supa.auth.signUp({
      email: email,
      password: password
    });
    if(error){ alert("Kayıt başarısız: " + error.message); return; }

    // çiftlik tablosuna kaydet
    await supa.from("farms").insert({
      user_id: data.user.id,
      farm_name: farmName
    });

    // cüzdan tablosuna başlangıç bakiyesi ekle (1000 FARM)
    await supa.from("wallets").insert({
      user_id: data.user.id,
      balance: 1000
    });

    alert("Kayıt başarılı! Oyuna yönlendiriliyorsunuz...");
    window.location.href = "game.html";
  }

  // Giriş yap
  async function login(email, password){
    const { error } = await supa.auth.signInWithPassword({
      email: email,
      password: password
    });
    if(error){ alert("Giriş başarısız: " + error.message); return; }

    window.location.href = "game.html";
  }

  // Oturum kontrolü (beni hatırla)
  async function checkSession(){
    const { data: { user } } = await supa.auth.getUser();
    if(user){
      window.location.href = "game.html";
    }
  }
  document.addEventListener("DOMContentLoaded", checkSession);
</script>
