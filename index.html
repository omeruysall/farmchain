<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Farm‑Chain — Çiftlik x Kripto</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#070910; --ink:#e9eef3; --muted:#a8b1c4; --border:rgba(255,255,255,.12);
    --glass:rgba(255,255,255,.06); --emerald:#34d399; --teal:#14b8a6; --indigo:#7aa2ff;
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;color:var(--ink);background:var(--bg);font:16px/1.55 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;overflow-x:hidden}

  /* Backdrop */
  .backdrop{position:fixed;inset:0;z-index:-3;overflow:hidden}
  .split{position:absolute;inset:-10vmax;filter:blur(60px);
    background:radial-gradient(60% 50% at 20% 40%, rgba(52,211,153,.28), transparent 60%),
               radial-gradient(45% 45% at 80% 60%, rgba(122,162,255,.28), transparent 60%);
    animation:breathe 18s ease-in-out infinite}
  .grain{position:fixed;inset:0;z-index:-2;opacity:.08;background-image:repeating-conic-gradient(from 0deg,#fff 0deg 2deg,transparent 2deg 4deg)}
  @keyframes breathe{0%,100%{transform:scale(1)}50%{transform:scale(1.07)}}

  /* Layout */
  .wrap{display:grid;min-height:100svh;max-width:120rem;margin:0 auto;grid-template-columns:1fr}
  @media (min-width:980px){.wrap{grid-template-columns:340px 1fr}}

  /* Sidebar */
  .sidebar{position:relative;padding:24px;border-right:1px solid var(--border);
    background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));backdrop-filter:blur(14px)}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:46px;height:46px;display:grid;place-items:center;color:#0c1110;border-radius:16px;
    background:linear-gradient(135deg,var(--emerald),var(--teal));box-shadow:0 0 0 5px rgba(255,255,255,.12)}
  .kicker{font-size:11px;letter-spacing:.18em;color:#bfffe6}
  .title{margin:2px 0 0;font-weight:800;font-size:20px}
  .frame{margin:18px 0;padding:1px;border-radius:20px;background:linear-gradient(135deg, rgba(52,211,153,.35), rgba(52,211,153,.08), transparent);border:1px solid rgba(52,211,153,.35)}
  .frame__inner{border-radius:19px;background:rgba(8,12,18,.75);padding:16px;backdrop-filter:blur(6px)}
  .cta{display:inline-flex;align-items:center;gap:10px;margin-top:8px;padding:10px 14px;border-radius:14px;border:1px solid rgba(52,211,153,.45);background:rgba(52,211,153,.12);color:#ccffe9;font-weight:700;text-decoration:none;transition:.2s}
  .cta:hover{transform:translateY(-1px);background:rgba(52,211,153,.2)}
  .snav{display:flex;flex-direction:column;gap:8px;margin-top:10px}
  .snav button,.snav a{text-align:left;padding:10px 14px;border-radius:14px;border:1px solid transparent;background:transparent;color:#d8deea;cursor:pointer;transition:.2s;font:inherit}
  .snav button:hover,.snav a:hover{background:rgba(255,255,255,.06)} .snav .active{background:rgba(255,255,255,.1);color:#fff;border-color:var(--border)}
  .sproof{margin-top:auto;display:grid;gap:8px;color:#cfe;opacity:.9;font-size:12px}

  /* Main */
  main{position:relative;padding:26px}
  .ribbon{position:absolute;left:-90px;top:28px;height:180px;width:min(62rem,95vw);transform:skewY(-6deg);filter:blur(18px);pointer-events:none;background:linear-gradient(90deg, rgba(52,211,153,.15), rgba(255,255,255,0) 45%, rgba(122,162,255,.15))}
  .hero{display:flex;gap:16px;flex-wrap:wrap;align-items:flex-end;justify-content:space-between;margin-bottom:16px}
  .h2{font-size:clamp(24px,2.8vw,38px);font-weight:800;margin:0}
  .lead{max-width:60ch;color:var(--muted);margin:.4rem 0 0}
  .badgebar{display:flex;gap:8px;padding:8px;border:1px solid var(--border);border-radius:16px;background:var(--glass)}
  .badge{padding:8px 12px;border-radius:12px;border:1px solid var(--border);background:transparent;color:#dce3ef;cursor:pointer}
  .badge.active{background:linear-gradient(135deg, rgba(52,211,153,.25), rgba(122,162,255,.25));color:#fff;border-color:rgba(255,255,255,.22);font-weight:700}
  .grid{display:grid;gap:16px;grid-template-columns:1fr}
  @media (min-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
  .card{border-radius:22px;padding:18px;background:rgba(255,255,255,.06);border:1px solid var(--border);backdrop-filter:blur(12px);box-shadow:0 14px 40px rgba(0,0,0,.35);transition:transform .18s,border-color .18s}
  .card:hover{transform:translateY(-2px);border-color:rgba(52,211,153,.28)}
  .tag{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,.1);border:1px solid var(--border);font-size:12px}
  .media{height:80px;border-radius:14px;margin:12px 0;background:linear-gradient(135deg, rgba(52,211,153,.15), rgba(20,184,166,.12), rgba(122,162,255,.12));border:1px solid var(--border)}
  .actions{display:flex;justify-content:space-between;align-items:center;gap:8px;color:var(--muted)}
  .btn{padding:8px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:#eaf2ff;cursor:pointer}
  .btn.em{border-color:rgba(52,211,153,.35);background:linear-gradient(135deg, rgba(52,211,153,.18), rgba(122,162,255,.18));color:#dfffee}
  .callout{margin-top:18px;padding:18px;border-radius:22px;border:1px solid var(--border);background:linear-gradient(135deg, rgba(255,255,255,.06), rgba(255,255,255,0))}
  .hide{display:none!important}

  /* Modal */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:50}
  .modal{width:min(520px,92vw);border-radius:20px;border:1px solid var(--border);background:rgba(15,18,24,.92);box-shadow:0 20px 60px rgba(0,0,0,.5);padding:20px}
  .modal h3{margin:0 0 10px}
  .field{display:flex;flex-direction:column;gap:6px;margin:10px 0}
  .field input[type="text"],.field input[type="email"],.field input[type="password"]{padding:10px 12px;border-radius:12px;border:1px solid var(--border);background:rgba(255,255,255,.06);color:#fff}
  .modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px}
  .link{color:#b9d9ff;text-decoration:underline;cursor:pointer}
  .helper{font-size:12px;color:var(--muted)}
  .checkbox{display:flex;align-items:center;gap:8px}
  .err{color:#ffb4b4;font-size:13px;min-height:18px}
</style>
</head>
<body>
  <!-- Backdrop -->
  <div class="backdrop"><div class="split"></div></div>
  <div class="grain"></div>

  <div class="wrap">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M12 3c6 0 9 6 9 9-3 0-9-3-9-9Z"/><path d="M12 3C6 3 3 9 3 12c3 0 9-3 9-9Zm0 0v18"/>
          </svg>
        </div>
        <div>
          <div class="kicker">FARM‑CHAIN</div>
          <div class="title" id="welcomeTitle">Hoşgeldiniz</div>
        </div>
      </div>

      <div class="frame">
        <div class="frame__inner">
          <p style="margin:0 0 10px;color:#cfe">Topraktan token’a: ürünlerini satın al, hasadını token’laştır!</p>
          <a class="cta" href="#giris" id="enterBtn">
            <span id="enterBtnText">Çiftliğe Giriş</span>
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M5 12h14M13 5l7 7-7 7"/></svg>
          </a>
        </div>
      </div>

      <nav class="snav">
        <button id="tab-market" class="active">Çiftlik Pazarı</button>
        <button id="tab-crypto">Kripto Pazar</button>
        <a href="#" aria-disabled="true">Hakkımızda</a>
      </nav>

      <div class="sproof">
        <div>🔒 Zincir üstü güvence • %0 gizli ücret</div>
        <div>⚡ Anlık fiyat akışı • Canlı hasat verisi</div>
      </div>
    </aside>

    <!-- MAIN -->
    <main>
      <div class="ribbon"></div>
      <section class="hero">
        <div>
          <h1 class="h2">Toprağın bereketi <span style="opacity:.6">×</span> blokzincirin gücü</h1>
          <p class="lead">Çiftlik ürünlerini şeffaf fiyatlarla keşfet, <strong>$FARM</strong> ile öde, NFT sertifikasıyla takip et.</p>
        </div>
        <div class="badgebar">
          <button class="badge active" id="badge-market">Ana Pazar</button>
          <button class="badge" id="badge-crypto">Kripto</button>
        </div>
      </section>

      <!-- MARKET -->
      <section id="view-market" class="grid">
        <article class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
            <h3 style="margin:0">Organik Zeytin</h3>
            <span class="tag">Aydın · Erken Hasat</span>
          </div>
          <div class="media"></div>
          <div class="actions">
            <div><strong style="color:#fff">₺220/lt</strong> · Stok: 38</div>
            <button class="btn em">Sepete Ekle</button>
          </div>
        </article>

        <article class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
            <h3 style="margin:0">Çiğ Süt</h3>
            <span class="tag">Balıkesir · Günlük</span>
          </div>
          <div class="media"></div>
          <div class="actions">
            <div><strong style="color:#fff">₺35/lt</strong> · Stok: 120</div>
            <button class="btn em">Sepete Ekle</button>
          </div>
        </article>

        <article class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
            <h3 style="margin:0">Serbest Gezen Yumurta</h3>
            <span class="tag">Manisa · XL</span>
          </div>
          <div class="media"></div>
          <div class="actions">
            <div><strong style="color:#fff">₺90/10'lu</strong> · Stok: 64</div>
            <button class="btn em">Sepete Ekle</button>
          </div>
        </article>
      </section>

      <!-- KRİPTO -->
      <section id="view-crypto" class="grid hide">
        <article class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
            <div>
              <div style="display:flex;gap:8px;align-items:center"><span class="tag">$FARM</span><h3 style="margin:0">Farm‑Chain</h3></div>
              <p style="margin:.35rem 0 0;color:#cfd">Fiyat: <strong style="color:#fff">$1.24</strong> <span style="color:#b8ffda;margin-left:8px">+4.2%</span></p>
            </div>
            <div class="logo" style="width:38px;height:38px;color:#e5fff6;background:linear-gradient(135deg, rgba(255,255,255,.18), rgba(255,255,255,.12))"></div>
          </div>
          <svg viewBox="0 0 100 32" style="width:100%;height:76px;border-radius:14px;background:rgba(0,0,0,.35);padding:8px">
            <polyline fill="none" stroke="#34d399" stroke-width="2" points="0,22 16,18 32,18 48,20 64,12 80,10 100,11"/>
          </svg>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button class="btn">Satın Al</button><button class="btn em">Takas Et</button>
          </div>
        </article>
      </section>

      <!-- Bilgilendirme -->
      <section class="callout">
        <h3 style="margin:.2rem 0 .3rem;font-size:18px">Çiftlikten Sofraya — Doğrudan</h3>
        <p style="margin:0;color:var(--muted)">Sipariş onayında zincir üstü makbuzun ve sevkiyat NFT’n hazırlanır.</p>
      </section>
    </main>
  </div>

  <!-- AUTH MODALS -->
  <div class="modal-backdrop" id="authBackdrop">
    <!-- Signup -->
    <div class="modal hide" id="signupModal" role="dialog" aria-modal="true">
      <h3>Çiftliğine isim ver</h3>
      <p class="helper">Kayıt sonrası otomatik oyuna yönlendireceğiz.</p>
      <div class="field">
        <label>Çiftlik Adı</label>
        <input type="text" id="suFarm" placeholder="Örn: Uysal Çiftliği" />
      </div>
      <div class="field">
        <label>E‑posta</label>
        <input type="email" id="suEmail" placeholder="ornek@mail.com" />
      </div>
      <div class="field">
        <label>Şifre</label>
        <input type="password" id="suPass" placeholder="••••••••" />
      </div>
      <label class="checkbox"><input type="checkbox" id="suRemember" /> Beni hatırla</label>
      <div class="err" id="suErr"></div>
      <div class="modal-actions">
        <button class="btn" id="suCancel">İptal</button>
        <button class="btn em" id="suSubmit">Kayıt Ol</button>
      </div>
      <p class="helper">Zaten üye misin? <span class="link" id="gotoLogin">Giriş yap</span></p>
    </div>

    <!-- Login -->
    <div class="modal hide" id="loginModal" role="dialog" aria-modal="true">
      <h3>Çiftliğe giriş yap</h3>
      <div class="field">
        <label>E‑posta</label>
        <input type="email" id="liEmail" placeholder="ornek@mail.com" />
      </div>
      <div class="field">
        <label>Şifre</label>
        <input type="password" id="liPass" placeholder="••••••••" />
      </div>
      <label class="checkbox"><input type="checkbox" id="liRemember" /> Beni hatırla</label>
      <div class="err" id="liErr"></div>
      <div class="modal-actions">
        <button class="btn" id="liCancel">İptal</button>
        <button class="btn em" id="liSubmit">Giriş Yap</button>
      </div>
      <p class="helper">Hesabın yok mu? <span class="link" id="gotoSignup">Kayıt ol</span></p>
    </div>
  </div>

  <!-- Supabase JS -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script>
    // Supabase client
    const supa = supabase.createClient(
      "https://gukdmxepdgwrwniectnq.supabase.co",   // Supabase Project URL
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd1a2RteGVwZGd3cnduaWVjdG5xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NzgyODAsImV4cCI6MjA3MTQ1NDI4MH0.57j4LbCHdhoaYl05PBTRjNyQAV3SxvL07GUredTDWZU"            // Supabase anon key
    );

    // Sekmeler (varsa ileride kullanırsın)
    const tabMarketBtn = document.getElementById('tab-market');
    const tabCryptoBtn = document.getElementById('tab-crypto');
    const badgeMarket = document.getElementById('badge-market');
    const badgeCrypto = document.getElementById('badge-crypto');
    const viewMarket = document.getElementById('view-market');
    const viewCrypto = document.getElementById('view-crypto');
    function setTab(which){
      const isMarket = which === 'market';
      viewMarket.classList.toggle('hide', !isMarket);
      viewCrypto.classList.toggle('hide', isMarket);
      tabMarketBtn.classList.toggle('active', isMarket);
      tabCryptoBtn.classList.toggle('active', !isMarket);
      badgeMarket.classList.toggle('active', isMarket);
      badgeCrypto.classList.toggle('active', !isMarket);
    }
    tabMarketBtn.onclick = () => setTab('market');
    tabCryptoBtn.onclick = () => setTab('crypto');
    badgeMarket.onclick = () => setTab('market');
    badgeCrypto.onclick = () => setTab('crypto');

    // Auth Modals
    const enterBtn = document.getElementById('enterBtn');
    const enterBtnText = document.getElementById('enterBtnText');
    const welcomeTitle = document.getElementById('welcomeTitle');
    const backdrop = document.getElementById('authBackdrop');
    const signupModal = document.getElementById('signupModal');
    const loginModal  = document.getElementById('loginModal');

    function openSignup(){ backdrop.style.display='flex'; signupModal.classList.remove('hide'); loginModal.classList.add('hide'); }
    function openLogin(){  backdrop.style.display='flex'; loginModal.classList.remove('hide');  signupModal.classList.add('hide'); }
    function closeModals(){ backdrop.style.display='none'; signupModal.classList.add('hide'); loginModal.classList.add('hide'); }

    // Oturum kontrolü (beni hatırla)
    async function checkSession(){
      const { data: { user } } = await supa.auth.getUser();
      if(user){
        // UI güncelle
        enterBtnText.textContent = 'Çiftliğe Giriş Yap';
        try{
          const { data } = await supa.from('farms').select('farm_name').eq('user_id', user.id).single();
          if(data?.farm_name){ welcomeTitle.textContent = data.farm_name + ' • Hoşgeldiniz'; }
        }catch(e){}
      }
    }
    document.addEventListener('DOMContentLoaded', checkSession);

    // Çiftliğe Giriş butonu → kayıt mı giriş mi?
    enterBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      supa.auth.getUser().then(({data:{user}})=>{
        user ? openLogin() : openSignup();
      });
    });

    // Modal bağlantıları & kapama
    document.getElementById('gotoLogin').onclick = openLogin;
    document.getElementById('gotoSignup').onclick = openSignup;
    document.getElementById('suCancel').onclick = closeModals;
    document.getElementById('liCancel').onclick = closeModals;
    backdrop.addEventListener('click', (e)=>{ if(e.target===backdrop) closeModals(); });

    // Kayıt ol
    document.getElementById('suSubmit').onclick = async () => {
      const farmName = document.getElementById('suFarm').value.trim();
      const email = document.getElementById('suEmail').value.trim();
      const password = document.getElementById('suPass').value;
      const remember = document.getElementById('suRemember').checked;
      const err = document.getElementById('suErr'); err.textContent='';

      if(!farmName || !email || !password){ err.textContent='Lütfen tüm alanları doldur.'; return; }

      const { data, error } = await supa.auth.signUp({ email, password });
      if(error){ err.textContent = error.message; return; }

      try{
        await supa.from('farms').insert({ user_id: data.user.id, farm_name: farmName });
      }catch(e){ /* tablo yoksa/migration eksikse burada hata alırsın */ }

      try{
        await supa.from('wallets').insert({ user_id: data.user.id, balance: 1000 });
      }catch(e){ /* wallets tablosu yoksa atlanır; tabloyu kurmanı öneririm */ }

      // “remember” Supabase tarafından otomatik yönetilir (refresh token)
      window.location.href = 'game.html';
    };

    // Giriş yap
    document.getElementById('liSubmit').onclick = async () => {
      const email = document.getElementById('liEmail').value.trim();
      const password = document.getElementById('liPass').value;
      const err = document.getElementById('liErr'); err.textContent='';

      const { error } = await supa.auth.signInWithPassword({ email, password });
      if(error){ err.textContent = error.message; return; }

      window.location.href = 'game.html';
    };
  </script>
</body>
</html>
